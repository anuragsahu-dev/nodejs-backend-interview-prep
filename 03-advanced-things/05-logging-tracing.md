# Logging and Tracing

## 1. What is Logging?

### Definition

Logging means recording important events happening inside your application so developers can debug and understand failures.

**Interview-ready explanation:**

"Logging is the process of capturing important runtime information like errors, requests, and system behavior so we can debug issues and monitor application health."

---

## 2. Log Levels

### Overview

Log levels indicate the severity of a log message.

### Common Log Levels

| Level     | When Used                                     |
| --------- | --------------------------------------------- |
| **debug** | Internal details useful for debugging         |
| **info**  | Normal operations                             |
| **warn**  | Unexpected but not breaking                   |
| **error** | Something failed and needs attention          |
| **fatal** | Critical failure causing application shutdown |

**Interview-ready explanation:**

"Log levels help filter logs based on severity so production only shows important logs."

---

## 3. Structured Logging (JSON Logs)

### What is Structured Logging?

Instead of plain text, logs are stored in JSON format to make them machine-readable and searchable.

### Example

**Plain text:**

```
User login failed: wrong password
```

**JSON log:**

```json
{
  "level": "error",
  "message": "User login failed",
  "userId": "123"
}
```

**Interview-ready explanation:**

"Structured logging uses JSON so logs are easier to search and analyze in production."

---

## 4. Node.js Logging Packages

### Morgan (HTTP Request Logger)

**Purpose:** Logs HTTP requests in Express applications

**Key Features:**

- Express middleware for HTTP request logging
- Pre-defined formats (combined, common, dev, short, tiny)
- Custom token support
- Good for development and debugging API calls
- Lightweight and simple

**Example output:**

```
GET /api/users 200 12ms
POST /api/login 401 5ms
```

**Use case:** Development environments, API request tracking

---

### Winston (General Purpose Logger)

**Purpose:** Full-featured application logging library

**Key Features:**

- Multiple log levels (debug, info, warn, error)
- Structured JSON logging
- Multiple transports (console, file, HTTP, cloud services)
- Custom formatters and metadata
- Log rotation support (with winston-daily-rotate-file)
- Production-ready with error handling
- Highly customizable

**Use case:** Production applications, complex logging requirements

---

### Pino (High-Performance Logger)

**Purpose:** Extremely fast JSON logger for Node.js

**Key Features:**

- **Fastest logger** - 5x faster than Winston
- Low overhead and minimal performance impact
- Asynchronous logging by default
- JSON-only output (structured logging)
- Child loggers for context
- Redaction support (hide sensitive data)
- Pretty printing for development (pino-pretty)
- Works great with microservices

**Use case:** High-performance applications, microservices, production systems where speed matters

---

### Comparison Table

| Feature            | Morgan        | Winston               | Pino                     |
| ------------------ | ------------- | --------------------- | ------------------------ |
| **Purpose**        | HTTP requests | General logging       | High-performance logging |
| **Performance**    | Fast          | Moderate              | Fastest                  |
| **JSON support**   | Limited       | Yes                   | JSON-only                |
| **Log levels**     | No            | Yes                   | Yes                      |
| **Transports**     | Console only  | Multiple              | Multiple (via plugins)   |
| **Async logging**  | No            | Optional              | Default                  |
| **Best for**       | Development   | Production (flexible) | Production (performance) |
| **Learning curve** | Easy          | Medium                | Easy-Medium              |

### Interview-friendly Summary

- **Morgan** → HTTP request logging (Express middleware)
- **Winston** → Application logging with flexibility (JSON, transports, custom formats)
- **Pino** → High-performance logging for production (fastest, async, JSON-only)

---

## 5. Correlation IDs

### What are Correlation IDs?

A correlation ID is a unique ID added to each request so all logs generated by that request can be connected.

### Why it's Used?

- Helps track a single request end-to-end
- Very useful when debugging across multiple services or even in a monolith

**Interview-ready explanation:**

"Correlation IDs help track a single request across multiple logs by assigning a unique ID to that request."

---

## 6. Tracing (Basic Overview)

### What is Tracing?

Tracing shows how a request flows through the system.

### Trace vs Span

- **Trace** → Entire journey of a request
- **Span** → One step inside that journey (DB query, API call, etc.)

### Why it's Important

- Helps find slow operations
- Shows where request failed
- Used heavily in microservices

**Interview-ready explanation:**

"Tracing follows the lifecycle of a request using spans and helps identify latency issues or failures."

---

## 7. Log Rotation

### What is Log Rotation?

Log rotation prevents log files from growing too large by:

- Creating a new log file periodically
- Archiving old logs
- Deleting very old logs

**Interview-ready explanation:**

"Log rotation avoids disk overflow by creating new log files and archiving old ones."

---

## 8. Logging vs Tracing vs Monitoring

### Comparison

| Concept        | Purpose                 | Answers...       |
| -------------- | ----------------------- | ---------------- |
| **Logging**    | Records events          | What happened?   |
| **Tracing**    | Shows request lifecycle | How did it flow? |
| **Monitoring** | Tracks system health    | Is it healthy?   |

**Interview-ready explanation:**

"Logging tells what happened, tracing shows how a request moved through the system, and monitoring checks system health."

---

## 9. Production Log Storage

### Why Not Store Logs on the Server?

- Logs get lost if server crashes
- Hard to collect from multiple servers
- Logs can fill disk storage

### Common Log Storage Tools

- **AWS CloudWatch**
- **ELK Stack** (Elasticsearch, Logstash, Kibana)
- **Datadog**
- **Grafana Loki**
- **Google Cloud Logging**
- **Better Stack**

---

## 10. Interview Summary

- **Logging** = Capturing runtime events
- **Log levels** = debug, info, warn, error, fatal
- **Structured logging** = JSON logs
- **Logging packages:**
  - **Morgan** = HTTP request logs (Express middleware)
  - **Winston** = Application logs with JSON + transports + flexibility
  - **Pino** = Fastest logger, async, JSON-only, best for production performance
- **Correlation ID** = Connect logs of same request
- **Tracing** = Request flow using spans
- **Log rotation** = Avoid huge log files
- **Logging vs Tracing vs Monitoring** = What happened / How it flowed / Is it healthy
- **Production** = Store logs externally in services like CloudWatch, ELK, Datadog
